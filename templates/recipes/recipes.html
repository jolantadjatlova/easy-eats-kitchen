{% extends "base.html" %} {% load static %} {% block content %}
<div class="container my-4">
  <h1 class="mb-3">Recipes</h1>

  <!-- Search -->
  <form class="mb-4" method="get" role="search">
    <div class="input-group">
      <input
        type="search"
        name="q"
        class="form-control"
        placeholder="Search recipes"
        aria-label="Search recipes"
        value="{{ q|default:'' }}"
      />
      <button
        class="btn"
        type="submit"
        style="background-color: #3a2f29; color: #f5f1eb"
      >
        Search
      </button>
    </div>
  </form>

  <!-- Accordion -->
  <div class="accordion" id="recipesAccordion">
    {% for r in recipes %}
    <div class="accordion-item mb-3">
      <h2 class="accordion-header" id="heading{{ r.id }}">
        <button
          class="accordion-button {% if not forloop.first %}collapsed{% endif %}"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#collapse{{ r.id }}"
          aria-expanded="{% if forloop.first %}true{% else %}false{% endif %}"
          aria-controls="collapse{{ r.id }}"
        >
          {{ r.title }}
        </button>
      </h2>

      <div
        id="collapse{{ r.id }}"
        class="accordion-collapse collapse {% if forloop.first %}show{% endif %}"
        aria-labelledby="heading{{ r.id }}"
        data-bs-parent="#recipesAccordion"
      >
        <div class="accordion-body">
          <div class="row g-3 align-items-start">
            <!-- Image -->
            <div class="col-12 col-md-3 text-center">
              {% if r.image %}
              <img
                src="{{ r.image.url }}"
                alt="{{ r.title }}"
                class="img-fluid rounded-circle"
                style="max-width: 140px"
              />
              {% else %}
              <img
                src="{% static 'images/recipe_placeholder.png' %}"
                alt="{{ r.title }}"
                class="img-fluid rounded-circle"
                style="max-width: 140px"
              />
              {% endif %}
            </div>

            <!-- Ingredients -->
            <div class="col-12 col-md-4">
              <h3 class="h5">Ingredients</h3>
              <div class="mb-0">{{ recipe.ingredients|safe }}</div>

              <!-- Method -->
              <div class="col-12 col-md-5">
                <h3 class="h5">Method</h3>
                <div class="mb-0">{{ recipe.method|safe }}</div>
              </div>
            </div>
          </div>
        </div>
        {% empty %}
        <p>No recipes found.</p>
        {% endfor %}
      </div>
    </div>
    {% endblock %}
  </div>
</div>
